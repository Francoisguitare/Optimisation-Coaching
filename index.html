<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chrono-Track Ultimate</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Dependencies required for Recharts -->
    <!-- Prop-types is required by Recharts UMD -->
    <script crossorigin src="https://unpkg.com/prop-types@15.8.1/prop-types.min.js"></script>
    
    <!-- React & ReactDOM (UMD) - Version 18.2.0 stable -->
    <script crossorigin src="https://unpkg.com/react@18.2.0/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.development.js"></script>
    
    <!-- Recharts (UMD) - Version 2.12.7 (Stable) -->
    <script crossorigin src="https://unpkg.com/recharts@2.12.7/umd/Recharts.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        body { font-family: 'Outfit', sans-serif; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        /* Simple animations */
        .animate-in { animation: fadeIn 0.3s ease-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.2.3",
    "react-dom/": "https://esm.sh/react-dom@^19.2.3/",
    "react/": "https://esm.sh/react@^19.2.3/",
    "lucide-react": "https://esm.sh/lucide-react@^0.561.0",
    "recharts": "https://esm.sh/recharts@^3.6.0"
  }
}
</script>
</head>
<body class="bg-gray-50 text-slate-800">
    <div id="root"></div>

    <script type="text/babel">
        // --- 1. GLOBALS & SETUP ---
        const { useState, useEffect, useRef, useMemo, useCallback } = React;
        const { createRoot } = ReactDOM;
        
        // Safety check for Recharts
        const Recharts = window.Recharts || {};
        // Default to empty components if library fails to load to prevent white screen crash
        const { 
            BarChart = () => null, 
            Bar = () => null, 
            XAxis = () => null, 
            Tooltip = () => null, 
            ResponsiveContainer = ({children}) => <div>{children}</div>, 
            Cell = () => null 
        } = Recharts;

        // --- 2. ICONS (Inline Replacement for lucide-react) ---
        const IconBase = ({ children, size = 24, className = "", ...props }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className} {...props}>{children}</svg>
        );

        const Icons = {
            X: (props) => <IconBase {...props}><path d="M18 6 6 18"/><path d="m6 6 12 12"/></IconBase>,
            Play: (props) => <IconBase {...props}><polygon points="5 3 19 12 5 21 5 3"/></IconBase>,
            Pause: (props) => <IconBase {...props}><rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/></IconBase>,
            Plus: (props) => <IconBase {...props}><path d="M5 12h14"/><path d="M12 5v14"/></IconBase>,
            Ghost: (props) => <IconBase {...props}><path d="M9 22v-2a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2"/><path d="M9 22a2 2 0 0 1-2-2v-2c0-1.1.9-2 2-2h4a2 2 0 0 1 2 2v2a2 2 0 0 1-2 2"/><path d="M18 14V8a6 6 0 0 0-12 0v6"/></IconBase>,
            Clock: (props) => <IconBase {...props}><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></IconBase>,
            TrendingUp: (props) => <IconBase {...props}><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/></IconBase>,
            Trophy: (props) => <IconBase {...props}><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17"/><path d="M14 14.66V17"/><path d="M18 2h-4a4 4 0 0 0-8 0H4a2 2 0 0 0-2 2v1a12 12 0 0 0 12 12h0a12 12 0 0 0 12-12V4a2 2 0 0 0-2-2Z"/><path d="m8.5 19.5 7 7"/><path d="m8.5 26.5 7-7"/></IconBase>,
            Trash2: (props) => <IconBase {...props}><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></IconBase>,
            UserPlus: (props) => <IconBase {...props}><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><line x1="19" x2="19" y1="8" y2="14"/><line x1="22" x2="16" y1="11" y2="11"/></IconBase>,
            Search: (props) => <IconBase {...props}><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></IconBase>,
            Calendar: (props) => <IconBase {...props}><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></IconBase>,
            Save: (props) => <IconBase {...props}><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></IconBase>,
            PlusCircle: (props) => <IconBase {...props}><circle cx="12" cy="12" r="10"/><path d="M8 12h8"/><path d="M12 8v8"/></IconBase>,
            Check: (props) => <IconBase {...props}><polyline points="20 6 9 17 4 12"/></IconBase>,
            Timer: (props) => <IconBase {...props}><line x1="10" x2="14" y1="2" y2="2"/><line x1="12" x2="15" y1="14" y2="11"/><circle cx="12" cy="14" r="8"/></IconBase>,
            PieChart: (props) => <IconBase {...props}><path d="M21.21 15.89A10 10 0 1 1 8 2.83"/><path d="M22 12A10 10 0 0 0 12 2v10z"/></IconBase>,
            History: (props) => <IconBase {...props}><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/><path d="M12 7v5l4 2"/></IconBase>,
            Users: (props) => <IconBase {...props}><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></IconBase>
        };

        // --- 3. SERVICES ---
        const STORAGE_KEYS = { STUDENTS: 'chrono_track_students', SESSIONS: 'chrono_track_sessions' };
        const delay = (ms) => new Promise(resolve => setTimeout(resolve, ms));
        
        const storageService = {
            async getStudents() {
                await delay(100);
                const data = localStorage.getItem(STORAGE_KEYS.STUDENTS);
                return data ? JSON.parse(data) : [];
            },
            async addStudent(name) {
                await delay(100);
                const students = await this.getStudents();
                const newStudent = { id: crypto.randomUUID(), name, createdAt: new Date().toISOString() };
                students.push(newStudent);
                localStorage.setItem(STORAGE_KEYS.STUDENTS, JSON.stringify(students));
                return newStudent;
            },
            async deleteStudent(id) {
                await delay(100);
                const students = await this.getStudents();
                const filtered = students.filter(s => s.id !== id);
                localStorage.setItem(STORAGE_KEYS.STUDENTS, JSON.stringify(filtered));
            },
            async getSession(id) {
                await delay(50);
                const sessions = await this.getAllSessions();
                return sessions.find(s => s.id === id) || null;
            },
            async getAllSessions() {
                const data = localStorage.getItem(STORAGE_KEYS.SESSIONS);
                return data ? JSON.parse(data) : [];
            },
            async saveSession(session) {
                const sessions = await this.getAllSessions();
                const index = sessions.findIndex(s => s.id === session.id);
                if (index >= 0) sessions[index] = session;
                else sessions.push(session);
                localStorage.setItem(STORAGE_KEYS.SESSIONS, JSON.stringify(sessions));
            },
            async getSessionsByDatePrefix(prefix) {
                await delay(100);
                const sessions = await this.getAllSessions();
                return sessions.filter(s => s.id.startsWith(prefix));
            }
        };

        // --- 4. COMPONENTS ---

        const Button = ({ children, variant = 'primary', size = 'md', className = '', ...props }) => {
            const baseStyles = "inline-flex items-center justify-center font-medium rounded-lg transition-all focus:outline-none focus:ring-2 focus:ring-offset-1 disabled:opacity-50 disabled:cursor-not-allowed";
            const variants = {
                primary: "bg-indigo-600 text-white hover:bg-indigo-700 shadow-lg shadow-indigo-200 focus:ring-indigo-500",
                secondary: "bg-white text-gray-700 hover:bg-gray-50 border border-gray-200 shadow-sm focus:ring-gray-200",
                danger: "bg-red-50 text-red-600 hover:bg-red-100 border border-red-100 focus:ring-red-500",
                ghost: "text-gray-500 hover:text-gray-800 hover:bg-gray-100 focus:ring-gray-200",
                outline: "border-2 border-indigo-600 text-indigo-600 hover:bg-indigo-50 focus:ring-indigo-500"
            };
            const sizes = { sm: "px-3 py-1.5 text-xs", md: "px-4 py-2 text-sm", lg: "px-6 py-3 text-base", icon: "p-2 aspect-square" };
            return (
                <button className={`${baseStyles} ${variants[variant]} ${sizes[size]} ${className}`} {...props}>
                    {children}
                </button>
            );
        };

        const Modal = ({ isOpen, onClose, title, children }) => {
            useEffect(() => {
                const handleEscape = (e) => { if (e.key === 'Escape') onClose(); };
                if (isOpen) window.addEventListener('keydown', handleEscape);
                return () => window.removeEventListener('keydown', handleEscape);
            }, [isOpen, onClose]);
            if (!isOpen) return null;
            return (
                <div className="fixed inset-0 z-50 flex items-center justify-center p-4">
                    <div className="absolute inset-0 bg-black/30 backdrop-blur-sm transition-opacity" onClick={onClose}></div>
                    <div className="bg-white rounded-2xl shadow-2xl w-full max-w-lg relative z-10 flex flex-col max-h-[90vh] animate-in fade-in zoom-in-95 duration-200">
                        <div className="p-5 border-b border-gray-100 flex justify-between items-center bg-gray-50/50 rounded-t-2xl">
                            <h3 className="font-bold text-lg text-gray-800">{title}</h3>
                            <button onClick={onClose} className="text-gray-400 hover:text-gray-600 hover:bg-gray-100 p-2 rounded-full transition-colors"><Icons.X size={20} /></button>
                        </div>
                        <div className="p-5 overflow-y-auto custom-scrollbar">{children}</div>
                    </div>
                </div>
            );
        };

        const LiveView = ({ currentSession, students, onSessionUpdate }) => {
            const [activeStudentId, setActiveStudentId] = useState(null);
            const [isModalOpen, setIsModalOpen] = useState(false);
            const [tempSelectedStudents, setTempSelectedStudents] = useState(new Set());
            const timerRef = useRef(null);
            const [now, setNow] = useState(new Date());

            // Clock for the header
            useEffect(() => {
                const interval = setInterval(() => setNow(new Date()), 60000);
                return () => clearInterval(interval);
            }, []);

            // Timer Logic
            useEffect(() => {
                if (activeStudentId) {
                    timerRef.current = window.setInterval(() => {
                        const currentResult = currentSession.results[activeStudentId];
                        const currentPassages = currentResult?.passages || [];
                        
                        let newPassages = [...currentPassages];
                        if (newPassages.length === 0) {
                            if ((currentResult?.total || 0) > 0) {
                                newPassages = [currentResult.total];
                            } else {
                                newPassages = [0];
                            }
                        }

                        // Increment the last passage
                        newPassages[newPassages.length - 1] = newPassages[newPassages.length - 1] + 1;

                        onSessionUpdate({
                            ...currentSession,
                            results: {
                                ...currentSession.results,
                                [activeStudentId]: {
                                    total: (currentResult?.total || 0) + 1,
                                    passages: newPassages
                                }
                            }
                        });
                    }, 1000);
                } else if (timerRef.current) {
                    clearInterval(timerRef.current);
                    timerRef.current = null;
                }
                return () => { if (timerRef.current) clearInterval(timerRef.current); };
            }, [activeStudentId, currentSession, onSessionUpdate]);

            // Persist frequently
            useEffect(() => {
                const save = async () => await storageService.saveSession(currentSession);
                const debounce = setTimeout(save, 5000);
                return () => clearTimeout(debounce);
            }, [currentSession]);

            const toggleTimer = (id) => {
                const result = currentSession.results[id];
                if (!result || !result.passages || result.passages.length === 0) {
                   const initialTotal = result?.total || 0;
                   const initialPassages = result?.passages || (initialTotal > 0 ? [initialTotal] : [0]);
                   onSessionUpdate({
                     ...currentSession,
                     results: { ...currentSession.results, [id]: { total: initialTotal, passages: initialPassages } }
                   });
                }
                setActiveStudentId(activeStudentId === id ? null : id);
            };

            const startNewPassage = (e, id) => {
                e.stopPropagation();
                const result = currentSession.results[id];
                if (!result) return;
                const currentPassages = result.passages || (result.total > 0 ? [result.total] : [0]);
                onSessionUpdate({
                  ...currentSession,
                  results: {
                    ...currentSession.results,
                    [id]: { ...result, passages: [...currentPassages, 0] }
                  }
                });
            };

            const handleOpenModal = () => {
                setTempSelectedStudents(new Set(Object.keys(currentSession.results)));
                setIsModalOpen(true);
            };

            const toggleStudentSelection = (id) => {
                const next = new Set(tempSelectedStudents);
                if (next.has(id)) next.delete(id); else next.add(id);
                setTempSelectedStudents(next);
            };

            const confirmStudentSelection = () => {
                const newResults = { ...currentSession.results };
                tempSelectedStudents.forEach(id => { 
                    if (!newResults[id]) newResults[id] = { total: 0, passages: [0] }; 
                });
                Object.keys(newResults).forEach(id => {
                    if (!tempSelectedStudents.has(id) && newResults[id].total === 0) delete newResults[id];
                });
                onSessionUpdate({ ...currentSession, results: newResults });
                setIsModalOpen(false);
            };

            const formatTime = (seconds) => {
                const m = Math.floor(seconds / 60);
                const s = seconds % 60;
                return `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
            };

            const activeParticipantIds = Object.keys(currentSession.results);
            const totalSessionTime = activeParticipantIds.reduce((acc, id) => acc + (currentSession.results[id]?.total || 0), 0);
            const averageTime = activeParticipantIds.length ? Math.floor(totalSessionTime / activeParticipantIds.length) : 0;

            return (
                <div className="flex flex-col h-full animate-in fade-in duration-300">
                    <div className="bg-white border-b border-gray-100 p-4 grid grid-cols-2 md:grid-cols-3 gap-4 shadow-sm z-10 sticky top-0">
                        <div className="text-center border-r border-gray-100">
                            <p className="text-xs text-gray-400 uppercase font-bold tracking-wider">Total Session</p>
                            <p className="text-2xl font-bold text-indigo-600 font-mono mt-1">{formatTime(totalSessionTime)}</p>
                        </div>
                        <div className="text-center md:border-r border-gray-100">
                            <p className="text-xs text-gray-400 uppercase font-bold tracking-wider">Moyenne</p>
                            <p className="text-2xl font-bold text-gray-700 font-mono mt-1">{formatTime(averageTime)}</p>
                        </div>
                        <div className="hidden md:block text-center">
                            <p className="text-xs text-gray-400 uppercase font-bold tracking-wider">Date</p>
                            <p className="text-sm font-medium text-gray-600 mt-2">{now.toLocaleDateString('fr-FR', { weekday: 'long', day: 'numeric', month: 'long' })}</p>
                        </div>
                    </div>

                    <div className="flex-1 overflow-y-auto p-4 bg-gray-50/50">
                        <div className="max-w-3xl mx-auto space-y-3">
                            {activeParticipantIds.length === 0 ? (
                                <div className="flex flex-col items-center justify-center py-20 text-gray-400">
                                    <Icons.Ghost size={48} className="mb-4 opacity-20" />
                                    <p className="text-lg font-medium">Aucun participant actif</p>
                                    <p className="text-sm">Cliquez sur "Sélectionner" pour commencer</p>
                                </div>
                            ) : (
                                activeParticipantIds.map((id) => {
                                    const student = students.find((s) => s.id === id);
                                    if (!student) return null;
                                    const result = currentSession.results[id];
                                    const isActive = activeStudentId === id;
                                    const passages = result.passages || (result.total > 0 ? [result.total] : [0]);
                                    const currentPassageIndex = passages.length - 1;
                                    const currentPassageTime = passages[currentPassageIndex];

                                    return (
                                        <div key={id} className={`bg-white p-4 rounded-xl shadow-sm border transition-all duration-300 ${isActive ? 'border-indigo-400 shadow-indigo-100 ring-1 ring-indigo-50 scale-[1.02]' : 'border-gray-200 hover:border-indigo-200'} flex flex-col sm:flex-row items-center justify-between gap-4 group`}>
                                            <div className="flex-1 min-w-0 w-full sm:w-auto flex items-center gap-3">
                                                 <div className={`h-10 w-10 rounded-full flex items-center justify-center font-bold text-sm transition-colors ${isActive ? 'bg-indigo-600 text-white' : 'bg-indigo-50 text-indigo-600'}`}>{passages.length}</div>
                                                 <div className="flex-1">
                                                     <h3 className={`font-bold text-lg truncate ${isActive ? 'text-indigo-900' : 'text-gray-700'}`}>{student.name}</h3>
                                                     <div className="flex items-center gap-2 text-xs text-gray-400 font-medium">
                                                        <Icons.History size={12} />
                                                        <span>Total: {formatTime(result.total)}</span>
                                                        {passages.length > 1 && <span>• Dernier: {formatTime(passages[currentPassageIndex - 1] || 0)}</span>}
                                                     </div>
                                                 </div>
                                            </div>

                                            <div className="flex items-center gap-4 w-full sm:w-auto justify-between sm:justify-end">
                                                <div className="flex flex-col items-end">
                                                    <span className="text-[10px] uppercase font-bold text-gray-400 tracking-wider">Passage {passages.length}</span>
                                                    <div className={`font-mono text-3xl font-bold w-28 text-right tabular-nums ${isActive ? 'text-indigo-600' : 'text-gray-400'}`}>{formatTime(currentPassageTime)}</div>
                                                </div>

                                                <div className="flex items-center gap-2">
                                                    <button onClick={(e) => startNewPassage(e, id)} className="h-10 w-10 rounded-lg flex items-center justify-center bg-gray-50 text-gray-500 hover:bg-indigo-50 hover:text-indigo-600 border border-gray-200 hover:border-indigo-200 transition-all active:scale-95"><Icons.Plus size={18} /></button>
                                                    <button onClick={() => toggleTimer(id)} className={`h-12 w-12 rounded-full flex items-center justify-center shadow-md transition-all active:scale-95 focus:outline-none focus:ring-2 focus:ring-offset-2 ${isActive ? 'bg-indigo-600 text-white ring-indigo-300' : 'bg-white text-gray-700 hover:bg-gray-50 ring-gray-200 border border-gray-100'}`}>
                                                        {isActive ? <Icons.Pause className="fill-current" size={20} /> : <Icons.Play className="fill-current ml-1" size={20} />}
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    );
                                })
                            )}
                        </div>
                    </div>
                    <div className="bg-white border-t border-gray-200 p-4 shadow-lg z-20">
                        <div className="max-w-3xl mx-auto flex justify-between items-center">
                            <div className="text-sm text-gray-500 font-medium"><span className="text-indigo-600 font-bold">{activeParticipantIds.length}</span> participants</div>
                            <Button onClick={handleOpenModal} className="rounded-full shadow-indigo-200 shadow-lg"><Icons.Plus size={18} className="mr-2" /> Sélectionner</Button>
                        </div>
                    </div>
                    <Modal isOpen={isModalOpen} onClose={() => setIsModalOpen(false)} title="Gérer les participants">
                        <div className="space-y-2 mb-6">
                            {students.length === 0 ? <p className="text-center text-gray-500 py-4">Aucun élève enregistré.</p> : students.map(student => {
                                const isSelected = tempSelectedStudents.has(student.id);
                                return (
                                    <label key={student.id} className={`flex items-center space-x-3 p-3 rounded-lg border cursor-pointer transition-colors ${isSelected ? 'bg-indigo-50 border-indigo-200' : 'bg-white border-gray-100 hover:bg-gray-50'}`}>
                                        <input type="checkbox" className="h-5 w-5 text-indigo-600 rounded focus:ring-indigo-500 border-gray-300" checked={isSelected} onChange={() => toggleStudentSelection(student.id)} />
                                        <span className={`font-medium ${isSelected ? 'text-indigo-900' : 'text-gray-700'}`}>{student.name}</span>
                                    </label>
                                );
                            })}
                        </div>
                        <div className="pt-4 border-t border-gray-100">
                            <Button onClick={confirmStudentSelection} className="w-full py-3 text-lg">Valider la sélection</Button>
                        </div>
                    </Modal>
                </div>
            );
        };

        const DashboardView = ({ students }) => {
            const [filter, setFilter] = useState('daily');
            const [sessions, setSessions] = useState([]);

            useEffect(() => { storageService.getAllSessions().then(setSessions); }, []);

            const stats = useMemo(() => {
                const now = new Date();
                const todayStr = now.toISOString().split('T')[0];
                const filteredSessions = sessions.filter(s => {
                    const sessionDate = s.id.split('_')[0];
                    if (filter === 'daily') return sessionDate === todayStr;
                    if (filter === 'weekly') { const d = new Date(now); d.setDate(d.getDate() - 7); return sessionDate >= d.toISOString().split('T')[0]; }
                    const d = new Date(now); d.setMonth(d.getMonth() - 1); return sessionDate >= d.toISOString().split('T')[0];
                });
                const agg = {};
                filteredSessions.forEach(session => {
                    Object.entries(session.results).forEach(([studentId, result]) => {
                        agg[studentId] = (agg[studentId] || 0) + result.total;
                    });
                });
                const data = Object.keys(agg).map(id => ({
                    id, name: students.find(s => s.id === id)?.name || 'Inconnu', seconds: agg[id]
                })).sort((a, b) => b.seconds - a.seconds);
                const totalSeconds = data.reduce((acc, curr) => acc + curr.seconds, 0);
                const averageSeconds = data.length ? Math.floor(totalSeconds / data.length) : 0;
                return { data, totalSeconds, averageSeconds, topStudent: data[0] || null };
            }, [sessions, filter, students]);

            const formatHours = (s) => {
                const h = Math.floor(s / 3600), m = Math.floor((s % 3600) / 60);
                return h > 0 ? `${h}h ${m}m` : `${m}m ${s % 60}s`;
            };
            const formatTime = (s) => `${Math.floor(s / 60).toString().padStart(2, '0')}:${(s % 60).toString().padStart(2, '0')}`;

            if (!window.Recharts) {
                 return <div className="p-8 text-center text-gray-500 bg-gray-50 rounded-lg">Chargement des graphiques...</div>;
            }

            return (
                <div className="h-full overflow-y-auto bg-gray-50 p-4 md:p-6 animate-in fade-in slide-in-from-bottom-4 duration-300">
                    <div className="max-w-6xl mx-auto space-y-6">
                        <div className="flex flex-col md:flex-row justify-between items-center bg-white p-4 rounded-2xl border border-gray-200 shadow-sm gap-4">
                            <h2 className="font-bold text-xl text-gray-800 flex items-center gap-2"><Icons.TrendingUp className="text-indigo-600" /> Analyses</h2>
                            <div className="flex bg-gray-100 p-1 rounded-xl">
                                {['daily', 'weekly', 'monthly'].map((f) => (
                                    <button key={f} onClick={() => setFilter(f)} className={`px-4 py-2 rounded-lg text-sm font-medium transition-all ${filter === f ? 'bg-white text-indigo-600 shadow-sm' : 'text-gray-500 hover:text-gray-700 hover:bg-gray-200/50'}`}>
                                        {f === 'daily' ? "Aujourd'hui" : f === 'weekly' ? 'Hebdo' : 'Mensuel'}
                                    </button>
                                ))}
                            </div>
                        </div>
                        <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div className="bg-gradient-to-br from-indigo-600 to-indigo-700 text-white p-6 rounded-2xl shadow-xl shadow-indigo-200">
                                <div className="flex justify-between items-start mb-4"><div className="bg-white/20 p-2 rounded-lg"><Icons.Clock size={20} /></div><span className="text-indigo-100 text-xs font-medium uppercase tracking-wider">Total</span></div>
                                <h3 className="text-4xl font-bold">{formatHours(stats.totalSeconds)}</h3>
                                <p className="text-indigo-200 text-sm mt-1">Temps de parole cumulé</p>
                            </div>
                            <div className="bg-white p-6 rounded-2xl shadow-sm border border-gray-200">
                                <div className="flex justify-between items-start mb-4"><div className="bg-orange-100 text-orange-600 p-2 rounded-lg"><Icons.TrendingUp size={20} /></div><span className="text-gray-400 text-xs font-medium uppercase tracking-wider">Moyenne</span></div>
                                <h3 className="text-3xl font-bold text-gray-800">{formatTime(stats.averageSeconds)}</h3>
                                <p className="text-gray-500 text-sm mt-1">Par élève actif</p>
                            </div>
                            <div className="bg-white p-6 rounded-2xl shadow-sm border border-gray-200">
                                <div className="flex justify-between items-start mb-4"><div className="bg-yellow-100 text-yellow-600 p-2 rounded-lg"><Icons.Trophy size={20} /></div><span className="text-gray-400 text-xs font-medium uppercase tracking-wider">Top Orateur</span></div>
                                <h3 className="text-2xl font-bold text-gray-800 truncate" title={stats.topStudent?.name}>{stats.topStudent?.name || '-'}</h3>
                                <p className="text-indigo-500 font-mono font-medium mt-1">{stats.topStudent ? formatTime(stats.topStudent.seconds) : '00:00'}</p>
                            </div>
                        </div>
                        <div className="bg-white p-6 rounded-2xl shadow-sm border border-gray-200">
                            <h3 className="text-gray-500 text-sm font-semibold uppercase tracking-wider mb-6">Répartition du temps</h3>
                            <div className="h-64 w-full">
                                <ResponsiveContainer width="100%" height="100%">
                                    <BarChart data={stats.data.slice(0, 10)}>
                                        <XAxis dataKey="name" axisLine={false} tickLine={false} tick={{fill: '#9CA3AF', fontSize: 12}} dy={10} />
                                        <Tooltip cursor={{fill: '#F3F4F6'}} contentStyle={{borderRadius: '12px', border: 'none', boxShadow: '0 4px 6px -1px rgb(0 0 0 / 0.1)'}} />
                                        <Bar dataKey="seconds" radius={[6, 6, 0, 0]}>
                                            {stats.data.slice(0, 10).map((entry, index) => <Cell key={`cell-${index}`} fill={index === 0 ? '#4F46E5' : '#818CF8'} />)}
                                        </Bar>
                                    </BarChart>
                                </ResponsiveContainer>
                            </div>
                        </div>
                        <div className="bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden">
                            <table className="w-full text-sm text-left">
                                <thead className="bg-gray-50 border-b border-gray-100">
                                    <tr><th className="px-6 py-4 font-semibold text-gray-500 uppercase text-xs">Rang</th><th className="px-6 py-4 font-semibold text-gray-500 uppercase text-xs">Nom</th><th className="px-6 py-4 font-semibold text-gray-500 uppercase text-xs text-right">Temps</th></tr>
                                </thead>
                                <tbody className="divide-y divide-gray-50">
                                    {stats.data.map((s, i) => (
                                        <tr key={s.id} className="hover:bg-gray-50/50 transition-colors">
                                            <td className="px-6 py-4 text-gray-400 font-mono w-16">{i + 1}</td>
                                            <td className="px-6 py-4 font-medium text-gray-700">{s.name}</td>
                                            <td className="px-6 py-4 text-right font-mono text-indigo-600 font-bold">{formatTime(s.seconds)}</td>
                                        </tr>
                                    ))}
                                    {stats.data.length === 0 && <tr><td colSpan={3} className="px-6 py-8 text-center text-gray-400">Aucune donnée disponible</td></tr>}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            );
        };

        const StudentsView = ({ students, onStudentsChange }) => {
            const [searchTerm, setSearchTerm] = useState('');
            const [isAddModalOpen, setIsAddModalOpen] = useState(false);
            const [newStudentName, setNewStudentName] = useState('');
            const filteredStudents = students.filter(s => s.name.toLowerCase().includes(searchTerm.toLowerCase()));

            const handleAddStudent = async () => {
                if (!newStudentName.trim()) return;
                await storageService.addStudent(newStudentName.trim());
                setNewStudentName(''); setIsAddModalOpen(false); onStudentsChange();
            };

            const handleDeleteStudent = async (id) => {
                if (window.confirm('Êtes-vous sûr de vouloir supprimer cet élève ?')) {
                    await storageService.deleteStudent(id); onStudentsChange();
                }
            };

            return (
                <div className="h-full bg-gray-50 p-4 md:p-8 animate-in fade-in duration-300 flex flex-col">
                    <div className="max-w-4xl mx-auto w-full flex-1 flex flex-col">
                        <div className="flex flex-col md:flex-row justify-between items-end md:items-center gap-4 mb-6">
                            <div><h2 className="text-2xl font-bold text-gray-800">Liste des Élèves</h2><p className="text-gray-500 text-sm">Gérez votre classe et ajoutez de nouveaux participants.</p></div>
                            <Button onClick={() => setIsAddModalOpen(true)} className="w-full md:w-auto"><Icons.UserPlus size={18} className="mr-2" /> Nouvel Élève</Button>
                        </div>
                        <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-2 mb-4 flex items-center gap-2">
                            <Icons.Search className="text-gray-400 ml-2" size={20} />
                            <input type="text" placeholder="Rechercher..." className="flex-1 p-2 outline-none text-gray-700 placeholder-gray-400" value={searchTerm} onChange={(e) => setSearchTerm(e.target.value)} />
                        </div>
                        <div className="bg-white rounded-2xl shadow-sm border border-gray-200 flex-1 overflow-hidden flex flex-col">
                            <div className="overflow-y-auto custom-scrollbar flex-1 p-2">
                                {filteredStudents.length === 0 ? <div className="h-full flex flex-col items-center justify-center text-gray-400 py-12"><p>Aucun élève trouvé.</p></div> : (
                                    <div className="space-y-1">
                                        {filteredStudents.map(student => (
                                            <div key={student.id} className="flex justify-between items-center p-4 hover:bg-gray-50 rounded-xl group transition-colors">
                                                <div className="flex items-center gap-3"><div className="h-10 w-10 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center font-bold">{student.name.charAt(0).toUpperCase()}</div><span className="font-medium text-gray-700">{student.name}</span></div>
                                                <button onClick={() => handleDeleteStudent(student.id)} className="text-gray-300 hover:text-red-500 p-2 rounded-lg hover:bg-red-50 transition-all opacity-0 group-hover:opacity-100"><Icons.Trash2 size={18} /></button>
                                            </div>
                                        ))}
                                    </div>
                                )}
                            </div>
                            <div className="p-4 border-t border-gray-100 bg-gray-50 text-xs text-gray-500 text-center">{filteredStudents.length} élèves affichés</div>
                        </div>
                    </div>
                    <Modal isOpen={isAddModalOpen} onClose={() => setIsAddModalOpen(false)} title="Ajouter un élève">
                        <div className="space-y-4">
                            <div><label className="block text-sm font-medium text-gray-700 mb-1">Nom complet</label><input type="text" className="w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-indigo-500 outline-none" placeholder="Ex: Jean Dupont" value={newStudentName} onChange={(e) => setNewStudentName(e.target.value)} onKeyDown={(e) => e.key === 'Enter' && handleAddStudent()} autoFocus /></div>
                            <div className="flex justify-end gap-2 pt-2"><Button variant="secondary" onClick={() => setIsAddModalOpen(false)}>Annuler</Button><Button onClick={handleAddStudent}>Créer</Button></div>
                        </div>
                    </Modal>
                </div>
            );
        };

        const HistoryView = ({ students, onSessionUpdate }) => {
            const [selectedDate, setSelectedDate] = useState(new Date().toISOString().split('T')[0]);
            const [sessions, setSessions] = useState([]);
            const [selectedSessionId, setSelectedSessionId] = useState(null);
            const [loading, setLoading] = useState(false);
            const [newPassageValues, setNewPassageValues] = useState({});
            const [isAddModalOpen, setIsAddModalOpen] = useState(false);
            const [tempSelected, setTempSelected] = useState(new Set());

            const loadSessionsForDate = async (date) => {
                setLoading(true);
                const loaded = await storageService.getSessionsByDatePrefix(date);
                setSessions(loaded);
                if (loaded.length > 0 && (!selectedSessionId || !loaded.find(s => s.id === selectedSessionId))) {
                    setSelectedSessionId(loaded[0].id);
                } else if (loaded.length === 0) setSelectedSessionId(null);
                setLoading(false);
            };

            useEffect(() => { loadSessionsForDate(selectedDate); }, [selectedDate]);
            const currentSession = sessions.find(s => s.id === selectedSessionId);

            const getPassages = (res) => {
                if (res.passages && res.passages.length > 0) return res.passages;
                if (res.total > 0) return [res.total];
                return [];
            };

            const createNewSession = async () => {
                const id = `${selectedDate}_${Date.now()}`;
                await storageService.saveSession({ id, date: new Date().toISOString(), results: {} });
                await loadSessionsForDate(selectedDate); setSelectedSessionId(id);
            };

            const handleAddPassage = async (studentId) => {
                if (!currentSession) return;
                const vals = newPassageValues[studentId];
                if (!vals) return;
                const m = parseInt(vals.m) || 0;
                const s = parseInt(vals.s) || 0;
                const duration = (m * 60) + s;
                
                const currentResult = currentSession.results[studentId];
                const currentPassages = getPassages(currentResult);
                const newPassages = [...currentPassages, duration];
                const newTotal = newPassages.reduce((a, b) => a + b, 0);

                const updatedSession = { ...currentSession, results: { ...currentSession.results, [studentId]: { total: newTotal, passages: newPassages } } };
                await saveAndUpdate(updatedSession);
                setNewPassageValues(prev => ({ ...prev, [studentId]: { m: '', s: '' } }));
            };

            const handleDeletePassage = async (studentId, index) => {
                if (!currentSession) return;
                const currentResult = currentSession.results[studentId];
                const newPassages = [...getPassages(currentResult)];
                newPassages.splice(index, 1);
                const newTotal = newPassages.reduce((a, b) => a + b, 0);
                const updatedSession = { ...currentSession, results: { ...currentSession.results, [studentId]: { total: newTotal, passages: newPassages } } };
                await saveAndUpdate(updatedSession);
            };

            const handleDeleteStudent = async (studentId) => {
                if (!currentSession || !window.confirm("Retirer cet élève de la session ?")) return;
                const newResults = { ...currentSession.results }; delete newResults[studentId];
                const updatedSession = { ...currentSession, results: newResults };
                await saveAndUpdate(updatedSession);
            };

            const saveAndUpdate = async (session) => {
                await storageService.saveSession(session);
                onSessionUpdate(session);
                setSessions(prev => prev.map(s => s.id === session.id ? session : s));
            };

            const handleInputChange = (studentId, field, value) => {
                setNewPassageValues(prev => ({
                    ...prev, [studentId]: { ...(prev[studentId] || {m:'', s:''}), [field]: value }
                }));
            };

            const openAddModal = () => { setTempSelected(new Set(Object.keys(currentSession?.results || {}))); setIsAddModalOpen(true); };
            const confirmAddStudents = async () => {
                if (!currentSession) return;
                const newResults = { ...currentSession.results };
                tempSelected.forEach(id => { if (!newResults[id]) newResults[id] = { total: 0, passages: [] }; });
                const updatedSession = { ...currentSession, results: newResults };
                await saveAndUpdate(updatedSession); setIsAddModalOpen(false);
            };
            
            const formatTime = (seconds) => {
                const m = Math.floor(seconds / 60);
                const s = seconds % 60;
                return `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
            };

            return (
                <div className="flex flex-col h-full bg-white animate-in fade-in duration-300">
                    <div className="p-4 border-b border-gray-200 bg-gray-50">
                        <div className="flex flex-col md:flex-row justify-between items-center gap-4 mb-4 max-w-4xl mx-auto w-full">
                            <div><h2 className="font-bold text-lg text-gray-800">Historique & Corrections</h2><p className="text-xs text-gray-500">Ajoutez ou modifiez des sessions passées.</p></div>
                            <div className="flex items-center gap-2 bg-white p-1 rounded-lg border border-gray-200 shadow-sm"><Icons.Calendar size={16} className="text-gray-400 ml-2" /><input type="date" className="p-1 text-sm outline-none text-gray-700" value={selectedDate} onChange={(e) => setSelectedDate(e.target.value)} /></div>
                        </div>
                        <div className="max-w-4xl mx-auto w-full flex gap-2 overflow-x-auto pb-2 no-scrollbar">
                            {sessions.map((s, idx) => (
                                <button key={s.id} onClick={() => setSelectedSessionId(s.id)} className={`px-4 py-2 rounded-full text-sm font-medium transition whitespace-nowrap border ${selectedSessionId === s.id ? 'bg-indigo-600 text-white border-indigo-600 shadow-md' : 'bg-white text-gray-600 border-gray-200 hover:bg-gray-50'}`}>{s.id === selectedDate ? "Session Principale" : `Session ${idx + 1}`}</button>
                            ))}
                            <button onClick={createNewSession} className="px-3 py-2 rounded-full text-sm font-bold text-indigo-600 hover:bg-indigo-50 border border-dashed border-indigo-300 transition whitespace-nowrap flex items-center" title="Nouvelle Session"><Icons.PlusCircle size={16} /></button>
                        </div>
                    </div>
                    <div className="flex-1 overflow-y-auto p-4 md:p-8 bg-white">
                        <div className="max-w-3xl mx-auto">
                            {loading ? <div className="text-center py-10 text-gray-400">Chargement...</div> : !currentSession ? (
                                <div className="text-center py-12 border-2 border-dashed border-gray-200 rounded-xl"><p className="text-gray-500 mb-4">Aucune session pour cette date.</p><Button onClick={createNewSession}>Créer une session</Button></div>
                            ) : (
                                <div className="space-y-6">
                                    {Object.keys(currentSession.results).length === 0 ? <div className="text-center py-8 text-gray-400">Cette session est vide.</div> : Object.keys(currentSession.results).map(studentId => {
                                        const student = students.find(s => s.id === studentId);
                                        if (!student) return null;
                                        const result = currentSession.results[studentId];
                                        const passages = getPassages(result);
                                        const inputs = newPassageValues[studentId] || { m: '', s: '' };

                                        return (
                                            <div key={studentId} className="bg-white p-5 rounded-xl shadow-sm border border-gray-200 flex flex-col md:flex-row items-center justify-between gap-6">
                                                <div className="flex-1 w-full md:w-auto">
                                                    <div className="flex items-center gap-2 mb-2"><div className="font-bold text-lg text-gray-800">{student.name}</div><span className="text-[10px] font-bold text-gray-400 uppercase tracking-wider">Élève</span></div>
                                                    <div className="flex flex-wrap gap-2">
                                                        {passages.length === 0 && <span className="text-sm text-gray-400 italic">Aucun temps</span>}
                                                        {passages.map((p, idx) => (
                                                            <div key={idx} className="group relative bg-gray-50 text-gray-700 px-3 py-1 rounded-md font-mono text-sm font-medium flex items-center border border-gray-100 hover:border-red-200 transition-all cursor-default">
                                                                {formatTime(p)}
                                                                <button onClick={() => handleDeletePassage(studentId, idx)} className="absolute -top-1.5 -right-1.5 bg-white text-red-500 rounded-full border border-gray-200 shadow-sm p-0.5 opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-50"><Icons.X size={10} /></button>
                                                            </div>
                                                        ))}
                                                        {passages.length > 0 && <div className="flex items-center gap-1.5 ml-1 px-2 py-1 bg-indigo-50 text-indigo-700 rounded-md"><Icons.Clock size={12} /><span className="font-mono text-xs font-bold">{formatTime(result.total)}</span></div>}
                                                    </div>
                                                </div>
                                                <div className="flex items-end gap-2 w-full md:w-auto justify-end">
                                                    <div className="flex flex-col items-center"><label className="text-[10px] text-gray-300 font-bold uppercase tracking-wider mb-1">Min</label><input type="number" min="0" className="w-14 h-10 border border-gray-200 rounded-lg text-center font-bold text-gray-700 focus:ring-2 focus:ring-indigo-300 outline-none transition-all placeholder-gray-200" placeholder="0" value={inputs.m} onChange={(e) => handleInputChange(studentId, 'm', e.target.value)} /></div>
                                                    <div className="h-10 flex items-center pb-1 text-gray-300 font-bold">:</div>
                                                    <div className="flex flex-col items-center"><label className="text-[10px] text-gray-300 font-bold uppercase tracking-wider mb-1">Sec</label><input type="number" min="0" max="59" className="w-14 h-10 border border-gray-200 rounded-lg text-center font-bold text-gray-700 focus:ring-2 focus:ring-indigo-300 outline-none transition-all placeholder-gray-200" placeholder="0" value={inputs.s} onChange={(e) => handleInputChange(studentId, 's', e.target.value)} /></div>
                                                    <button onClick={() => handleAddPassage(studentId)} className="h-10 w-10 bg-indigo-400 hover:bg-indigo-500 text-white rounded-lg flex items-center justify-center transition-colors shadow-sm ml-1" title="Sauvegarder" disabled={(!inputs.m && !inputs.s)}><Icons.Save size={20} /></button>
                                                    <button onClick={() => handleDeleteStudent(studentId)} className="h-10 w-10 text-gray-300 hover:text-red-400 flex items-center justify-center transition-colors ml-1"><Icons.Trash2 size={18} /></button>
                                                </div>
                                            </div>
                                        );
                                    })}
                                    <div className="pt-6 border-t border-gray-100 flex justify-end"><Button onClick={openAddModal} variant="ghost" className="text-indigo-600 hover:text-indigo-700 hover:bg-indigo-50"><Icons.PlusCircle size={18} className="mr-2" /> Ajouter un élève</Button></div>
                                </div>
                            )}
                        </div>
                    </div>
                    <Modal isOpen={isAddModalOpen} onClose={() => setIsAddModalOpen(false)} title="Ajouter à la session">
                        <div className="space-y-2 mb-6">
                            {students.map(student => {
                                const isSelected = tempSelected.has(student.id);
                                const alreadyIn = currentSession?.results[student.id];
                                return (
                                    <label key={student.id} className={`flex items-center space-x-3 p-3 rounded-lg border cursor-pointer ${isSelected ? 'bg-indigo-50 border-indigo-200' : 'bg-white border-gray-100'}`}>
                                        <input type="checkbox" className="h-5 w-5 text-indigo-600 rounded" checked={isSelected} onChange={() => { const next = new Set(tempSelected); if(next.has(student.id)) next.delete(student.id); else next.add(student.id); setTempSelected(next); }} />
                                        <span className="font-medium text-gray-700">{student.name}</span>
                                        {alreadyIn && <span className="text-xs text-gray-400 ml-auto">(Déjà présent)</span>}
                                    </label>
                                );
                            })}
                        </div>
                        <Button onClick={confirmAddStudents} className="w-full">Confirmer l'ajout</Button>
                    </Modal>
                </div>
            );
        };

        const Layout = ({ currentView, onViewChange, children }) => {
            const NavButton = ({ view, label, icon: Icon }) => (
                <button onClick={() => onViewChange(view)} className={`flex items-center px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 whitespace-nowrap ${currentView === view ? 'bg-white text-indigo-600 shadow-sm' : 'text-gray-500 hover:text-gray-700 hover:bg-white/50'}`}>
                    <Icon size={16} className="mr-2" /> {label}
                </button>
            );
            return (
                <div className="flex flex-col h-screen bg-gray-50 overflow-hidden">
                    <nav className="bg-white border-b border-gray-200 px-4 py-3 flex justify-between items-center shadow-sm z-30 shrink-0">
                        <div className="flex items-center gap-3">
                            <div className="bg-gradient-to-br from-indigo-600 to-indigo-500 text-white p-2 rounded-lg shadow-md shadow-indigo-200"><Icons.Timer size={20} /></div>
                            <div>
                                <h1 className="font-bold text-lg leading-tight text-slate-800 hidden md:block">Chrono-Track <span className="text-indigo-600">Ultimate</span></h1>
                                <div className="flex items-center gap-1.5"><span className="relative flex h-2 w-2"><span className="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"></span><span className="relative inline-flex rounded-full h-2 w-2 bg-green-500"></span></span><p className="text-xs text-gray-500 font-medium">En ligne</p></div>
                            </div>
                        </div>
                        <div className="flex bg-gray-100/80 p-1 rounded-xl overflow-x-auto no-scrollbar gap-1">
                            <NavButton view="live" label="Live" icon={Icons.Timer} />
                            <NavButton view="dashboard" label="Stats" icon={Icons.PieChart} />
                            <NavButton view="history" label="Historique" icon={Icons.History} />
                            <NavButton view="students" label="Élèves" icon={Icons.Users} />
                        </div>
                    </nav>
                    <main className="flex-1 overflow-hidden relative">{children}</main>
                </div>
            );
        };

        const App = () => {
            const [view, setView] = useState('live');
            const [students, setStudents] = useState([]);
            const [todaySession, setTodaySession] = useState({ id: new Date().toISOString().split('T')[0], date: new Date().toISOString(), results: {} });

            useEffect(() => {
                const init = async () => {
                    setStudents(await storageService.getStudents());
                    const todayId = new Date().toISOString().split('T')[0];
                    const existing = await storageService.getSession(todayId);
                    if (existing) setTodaySession(existing);
                    else {
                        const newSession = { id: todayId, date: new Date().toISOString(), results: {} };
                        await storageService.saveSession(newSession);
                        setTodaySession(newSession);
                    }
                };
                init();
            }, []);

            const handleStudentsChange = async () => setStudents(await storageService.getStudents());
            const handleSessionUpdate = (updated) => setTodaySession(updated);

            return (
                <Layout currentView={view} onViewChange={setView}>
                    {view === 'live' && <LiveView currentSession={todaySession} students={students} onSessionUpdate={handleSessionUpdate} />}
                    {view === 'dashboard' && <DashboardView students={students} />}
                    {view === 'history' && <HistoryView students={students} onSessionUpdate={(s) => { if (s.id === todaySession.id) setTodaySession(s); }} />}
                    {view === 'students' && <StudentsView students={students} onStudentsChange={handleStudentsChange} />}
                </Layout>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>